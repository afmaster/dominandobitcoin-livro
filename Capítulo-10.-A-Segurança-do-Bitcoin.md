Manter bitcoins de maneira segura é desafiante porque eles não são uma referência abstrata a um valor, como o saldo em uma conta bancária. Bitcoin é essencialmente como notas de dinheiro ou ouro, porém virtual. Você provavelmente já escutou o ditado "a posse é 90% da lei". Bem, no mundo do bitcoin, a posse é 100% da lei. A posse das chaves para desbloquear o bitcoin é equivalente à posse de notas de dinheiro ou de uma barra de um metal precioso. Você pode perdê-las, esquecer onde guardou, ser roubado ou dar acidentalmente uma quantia errada para outra pessoa. Em cada uma dessas situações, da mesma maneira como se tivessem deixado cair notas de dinheiro na calçada, os usuários não tem a quem recorrer.

No entanto, o bitcoin tem capacidades que as notas, o ouro e as contas bancárias não tem. Como qualquer arquivo de computador, pode-se realizar um backup (cópia de segurança) de uma carteira de bitcoin contendo suas chaves. Ela pode ser armazenada em múltiplas cópias, e até mesmo impressa em papel para fazer um backup não-digital offline. Você não pode fazer um backup das suas notas de dinheiro, de ouro ou de suas contas bancárias. O bitcoin é tão diferente de tudo que já existiu, que também precisamos encarar sua segurança de uma maneira diferente daquilo que já estamos acostumados.

## Princípios de Segurança

O princípio fundamental do bitcoin é a descentralização e isso traz implicações importantes para a sua segurança. Modelos centralizados, como as redes de pagamento e o modelo bancário tradicional, dependem de controles de acesso e comprovações de segurança para manter o sistema livre de criminosos. Em comparação, um sistema descentralizado como o bitcoin atribui a responsabilidade e o controle aos usuários. Como a rede é baseada em prova de trabalho, e não em controle de acesso, a rede pode ser aberta, não exigindo criptografia para o tráfego de bitcoins.

Em uma rede de pagamentos tradicional, como o sistema de cartões de crédito, o pagamento é open-ended porque contém o identificador privado do usuário (o número do cartão de crédito). Após a cobrança inicial, qualquer pessoa com acesso ao identificador pode repetidamente sacar fundos e fazer cobranças ao dono do cartão. Logo, a rede de pagamento deve ser criptografada em toda sua extensão (end-to-end) e deve garantir que nenhum intruso ou intermediários possam comprometer o tráfego de pagamento, quando em trânsito ou quando estiver armazenado. Se um criminoso burlar o controle de acesso ao sistema, ele pode comprometer as transações atuais e os tokens de pagamentos que podem ser usados para criar novas transações. Ou, pior ainda, quando os dados dos consumidores são comprometidos, os consumidores são expostos a roubo de identidade e devem tomar medidas para prevenir o uso fraudulento de suas contas comprometidas.

Com o bitcoin, a história é completamente diferente. Uma transação bitcoin autoriza somente um valor específico e somente para um destinatário, não pode do ser forjada ou modificada. Ela não revela nenhuma informação privada, como as identidades dos usuários, e não pose ser utilizada para autorizar pagamentos adicionais. Logo, uma rede de pagamentos bitcoin não precisa ser encriptada ou protegida de intrusos. De fato, você pode transmitir transações em bitcoins usando um canal público aberto, como redes WiFi sem semnha ou Bluetooth, sem comprometer a segurança.

O modelo de segurança descentralizado do bitcoin coloca muito poder nas mãos dos usuários. E com esse poder, vem a responsabilidade de manter o segredo de suas chaves. Para a maioria dos usuários isso não é uma tarefa fácil, especialmente em dispositivos comuns como smartphones ou laptops. Embora o modelo descentralizado do bitcoin impeça o tipo de comprometimento em massa observado com os cartões de crédito, muitos usuários não são capazes de guardar suas chaves com segurança adequada, e acabam sendo hackeados, um a um.

### Desenvolvendo Sistemas Bitcoin de Maneira Segura

O princípio mais importante para os desenvolvedores bitcoin é a descentralização. A maioria dos desenvolvedores são acostumados com modelos de segurança centralizados e podem ter a tentação de aplicar estes modelos em seus aplicativos bitcoin, com resultados desastrosos.

A segurança do bitcoin depende do controle descentralizado das chaves e da validação independente das transações que é realizada pelos mineradores. Se você quiser manipular a segurança do bitcoin, você precisa se assegurar que está seguindo o modelo de segurança do bitcoin. Em termos simples: não retire dos usuários o controle de suas chaves e não realize transações fora da blockchain.

Por exemplo, muitas das primeiras exchanges de bitcoin concentravam todos os bitcoins dos usuários em uma única carteira "quente" que tinha as chaves armazenadas em um único servidor. Esse tipo de design retira o controle dos usuários e centraliza o controle das chaves em um único sistema. Muitos destes sistemas foram hackeados, com consequências desastrosas para seus consumidores.


Outro erro comum é o de realizar transações fora da blockchain, numa tentativa desastrada de reduzir taxas de transação ou de acelerar o processamento das transações. Um sistema fora da blockchain geralmente grava as transações em um ledger interno, centralizado e somente ocasionalmente realiza uma sincronização com a blockchain do bitcoin. Essa prática, novamente, substitui a segurança descentralizada do bitcoon por uma abordagem proprietária e centralizada. Quando as transações são realizadas fora da blockchain, os ledgers centralizados com pouca segurança podem ser falsificados, possibilitando que intrusos possam, sem chamar a atenção, desviar fundos e depletar reservas.

A menos que você esteja preparado para investimentos pesados em segurança operacional, múltiplas camadas de controle de acesso e auditorias (como os bancos tradicionais fazem), você deveria pensar com cuidado antes de retirar os fundos do contexto de segurança descentralizada do bitcoin. Mesmo que você tenha condições e disciplina para implementar um modelo de segurança robusto, este tipo de modelo apenas replica o modelo frágil das redes financeiras tradicionais, o qual é infestado por roubo de identidade, corrupção e fraude. Para aproveitar o modelo único de segurança descentralizada do bitcoin, você deve evitar a tentação das arquiteturas centralizadas que, por estarmos acostumados nos transmitem conforto, mas que por fim acabam subvertendo a segurança do bitcoin.

### The Root of Trust

Traditional security architecture is based upon a concept called the root of trust, which is a trusted core used as the foundation for the security of the overall system or application. Security architecture is developed around the root of trust as a series of concentric circles, like layers in an onion, extending trust outward from the center. Each layer builds upon the more-trusted inner layer using access controls, digital signatures, encryption, and other security primitives. As software systems become more complex, they are more likely to contain bugs, which make them vulnerable to security compromise. As a result, the more complex a software system becomes, the harder it is to secure. The root of trust concept ensures that most of the trust is placed within the least complex part of the system, and therefore least vulnerable, parts of the system, while more complex software is layered around it. This security architecture is repeated at different scales, first establishing a root of trust within the hardware of a single system, then extending that root of trust through the operating system to higher-level system services, and finally across many servers layered in concentric circles of diminishing trust.

Bitcoin security architecture is different. In Bitcoin, the consensus system creates a trusted public ledger that is completely decentralized. A correctly validated blockchain uses the genesis block as the root of trust, building a chain of trust up to the current block. Bitcoin systems can and should use the blockchain as their root of trust. When designing a complex bitcoin application that consists of services on many different systems, you should carefully examine the security architecture in order to ascertain where trust is being placed. Ultimately, the only thing that should be explicitly trusted is a fully validated blockchain. If your application explicitly or implicitly vests trust in anything but the blockchain, that should be a source of concern because it introduces vulnerability. A good method to evaluate the security architecture of your application is to consider each individual component and evaluate a hypothetical scenario where that component is completely compromised and under the control of a malicious actor. Take each component of your application, in turn, and assess the impacts on the overall security if that component is compromised. If your application is no longer secure when components are compromised, that shows you have misplaced trust in those components. A bitcoin application without vulnerabilities should be vulnerable only to a compromise of the bitcoin consensus mechanism, meaning that its root of trust is based on the strongest part of the bitcoin security architecture.

The numerous examples of hacked bitcoin exchanges serve to underscore this point because their security architecture and design fails even under the most casual scrutiny. These centralized implementations had invested trust explicitly in numerous components outside the bitcoin blockchain, such as hot wallets, centralized ledger databases, vulnerable encryption keys, and similar schemes.

## User Security Best Practices

Humans have used physical security controls for thousands of years. By comparison, our experience with digital security is less than 50 years old. Modern general-purpose operating systems are not very secure and not particularly suited to storing digital money. Our computers are constantly exposed to external threats via always-on Internet connections. They run thousands of software components from hundreds of authors, often with unconstrained access to the user’s files. A single piece of rogue software, among the many thousands installed on your computer, can compromise your keyboard and files, stealing any bitcoin stored in wallet applications. The level of computer maintenance required to keep a computer virus-free and trojan-free is beyond the skill level of all but a tiny minority of computer users.

Despite decades of research and advancements in information security, digital assets are still woefully vulnerable to a determined adversary. Even the most highly protected and restricted systems, in financial services companies, intelligence agencies, and defense contractors, are frequently breached. Bitcoin creates digital assets that have intrinsic value and can be stolen and diverted to new owners instantly and irrevocably. This creates a massive incentive for hackers. Until now, hackers had to convert identity information or account tokens—such as credit cards, and bank accounts—into value after compromising them. Despite the difficulty of fencing and laundering financial information, we have seen ever-escalating thefts. Bitcoin escalates this problem because it doesn’t need to be fenced or laundered; it is intrinsic value within a digital asset.

Fortunately, bitcoin also creates the incentives to improve computer security. Whereas previously the risk of computer compromise was vague and indirect, bitcoin makes these risks clear and obvious. Holding bitcoin on a computer serves to focus the user’s mind on the need for improved computer security. As a direct result of the proliferation and increased adoption of bitcoin and other digital currencies, we have seen an escalation in both hacking techniques and security solutions. In simple terms, hackers now have a very juicy target and users have a clear incentive to defend themselves.

Over the past three years, as a direct result of bitcoin adoption, we have seen tremendous innovation in the realm of information security in the form of hardware encryption, key storage and hardware wallets, multi-signature technology, and digital escrow. In the following sections we will examine various best practices for practical user security.

### Armazenamento Físico de Bitcoins

Como a maior parte dos usuários se sente muito mais confortável com segurança física do que com segurança da informação, um método muito efetivo para proteger bitcoins é convertê-los para uma forma física. As chaves de bitcoins nada mais são do que longos números. Isso significa que elas podem ser armazenadas em uma forma física, como, por exemplo, impressas em um papel ou gravadas em uma moeda de metal. Dessa maneira, manter a segurança das chaves se torna tão simples quanto manter seguro um papel com chaves de bitcoin impressas. Um conjunto de chaves de bitcoin impressas em papel é chamado de carteira em papel (paper wallet), e existem muitas ferramentas gratuitas que podem ser usadas para criá-la. Eu pessoalmente mantenho a grande maioria dos meus bitcoins (99% ou mais) armazenados em carteiras de papel, criptografadas com BIP0038, com múltiplas cópias trancadas em cofres. Manter bitcoins offline é conhecido como armazenamento frio (cold storage) e é uma das técnicas de segurança mais efetivas. Um sistema de armazenamento frio tanto gera quanto armazena as chaves de maneira offline (sem nunca se conectar à internet). As chaves geralmente são armazenadas em papel (impressas) ou mídia digital, como um pendrive.

### Carteiras de Hardware

A longo prazo, a segurança do bitcoin irá cada vez mais estar vinculada com carteiras de hardware à prova de falsificação. Diferentemente dos smartphones ou computadores de mesa, a carteira de hardware de bitcoin tem apenas um único propósito: armazenar bitcoins com segurança. Sem o risco de comprometimento por softwares de múltiplos propósitos e com interfaces limitadas, essas carteiras podem fornecer um nível altíssimo de segurança para usuários comuns, não especialistas. Eu espero ver as carteiras de hardware se tornando o método predominante de armazenamento de bitcoins. Para conhecer um exemplo deste tipo de carteira, pesquise sobre a carteira Trezor.

### Balancing Risk

Although most users are rightly concerned about bitcoin theft, there is an even bigger risk. Data files get lost all the time. If they contain bitcoin, the loss is much more painful. In the effort to secure their bitcoin wallets, users must be very careful not to go too far and end up losing the bitcoin. In the summer of 2010, a well-known bitcoin awareness and education project lost almost 7,000 bitcoins. In their effort to prevent theft, the owners had implemented a complex series of encrypted backups. In the end they accidentally lost the encryption keys, making the backups worthless and losing a fortune. Like hiding money by burying it in the desert, if you secure your bitcoin too well you might not be able to find it again.

### Diversifying Risk

Would you carry your entire net worth in cash in your wallet? Most people would consider that reckless, yet bitcoin users often keep all their bitcoin in a single wallet. Instead, users should spread the risk among multiple and diverse bitcoin wallets. Prudent users will keep only a small fraction, perhaps less than 5%, of their bitcoins in an online or mobile wallet as "pocket change." The rest should be split between a few different storage mechanisms, such as a desktop wallet and offline (cold storage).

### Multi-sig and Governance

Whenever a company or individual stores large amounts of bitcoin, they should consider using a multi-signature bitcoin address. Multi-signature addresses secure funds by requiring more than one signature to make a payment. The signing keys should be stored in a number of different locations and under the control of different people. In a corporate environment, for example, the keys should be generated independently and held by several company executives, to ensure no single person can compromise the funds. Multi-signature addresses can also offer redundancy, where a single person holds several keys that are stored in different locations.

### Survivability

One important security consideration that is often overlooked is availability, especially in the context of incapacity or death of the key holder. Bitcoin users are told to use complex passwords and keep their keys secure and private, not sharing them with anyone. Unfortunately, that practice makes it almost impossible for the user’s family to recover any funds if the user is not available to unlock them. In most cases, in fact, the families of bitcoin users might be completely unaware of the existence of the bitcoin funds.

If you have a lot of bitcoin, you should consider sharing access details with a trusted relative or lawyer. A more complex survivability scheme can be set up with multi-signature access and estate planning through a lawyer specialized as a "digital asset executor."

## Conclusão

O bitcoin é uma tecnologia nova, complexa e sem precedentes. Com o passar do tempo, iremos desenvolver melhores ferramentas de segurança e práticas que serão mais fáceis de serem utilizadas por pessoas comuns, não especialistas. Enquanto isso, os usuários de bitcoin podem usar muitas das dicas discutidas nesse capítulo para aproveitar uma experiência com bitcoins segura, livre de problemas.